<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>TACTICAL_OS | UNIT 1654</title>
    
    <meta name="theme-color" content="#0d1109">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="manifest.json">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@500;800&display=swap" rel="stylesheet">
    
    <style>
        :root { 
            --army-bg: #0d1109; 
            --army-green: #4b5320; 
            --army-bright: #8a9a5b; 
            --hazard: #d2691e;
            --text: #c5c5c5;
            --font-main: 'JetBrains Mono', monospace;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--army-bg); color: var(--text); font-family: var(--font-main); overflow: hidden; text-transform: uppercase; height: 100vh; }

        /* CRT Filter */
        body::after {
            content: " "; position: fixed; inset: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.05) 50%);
            background-size: 100% 4px; pointer-events: none; z-index: 10000;
        }

        #map { height: 100vh; width: 100%; filter: sepia(0.3) contrast(1.2) brightness(0.7); z-index: 1; transition: 0.3s; }

        .status-header {
            position: fixed; top: 0; left: 0; right: 0; z-index: 2000;
            background: rgba(13, 17, 9, 0.95); border-bottom: 2px solid var(--army-green);
            padding: 8px 12px; display: flex; justify-content: space-between; align-items: center; 
            font-size: 10px; backdrop-filter: blur(5px);
        }

        /* КНОПКА ПРИХОВУВАННЯ (HUD) */
        .hud-toggle {
            cursor: pointer; color: var(--army-bright); border: 1px solid var(--army-green);
            padding: 2px 8px; background: rgba(75, 83, 32, 0.2); transition: 0.2s;
        }
        .hud-toggle:active { background: var(--army-bright); color: var(--army-bg); }

        .tactical-list {
            position: fixed; right: 0; top: 45px; bottom: 100px; width: 300px;
            background: rgba(13, 17, 9, 0.9); border-left: 2px solid var(--army-green);
            z-index: 1500; padding: 10px; overflow-y: auto; scrollbar-width: none;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Клас для приховування */
        .hud-hidden { transform: translateX(100%); }

        .target-card { border: 1px solid var(--army-green); background: rgba(0,0,0,0.5); margin-bottom: 8px; padding: 10px; }
        .target-card.active { border-left: 4px solid var(--hazard); background: rgba(210, 105, 30, 0.1); }

        .supply-btn {
            position: fixed; bottom: 30px; right: 10px; width: 280px; height: 50px;
            background: var(--army-green); color: #fff; border: 2px solid var(--army-bright);
            display:flex; align-items:center; justify-content:center; z-index:1400; 
            text-decoration:none; font-size: 11px; transition: 0.3s;
        }
        .btn-hidden { transform: translateY(150%); }

        .disclaimer-bar {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: #000; color: var(--hazard);
            font-size: 8px; text-align: center; padding: 6px 5px;
            border-top: 1px solid var(--army-green); z-index: 3000;
        }

        @media (max-width: 768px) {
            .tactical-list { width: 100%; height: 35vh; top: auto; bottom: 85px; border-left: none; border-top: 2px solid var(--army-green); }
            .hud-hidden { transform: translateY(100%); }
            .supply-btn { width: calc(100% - 20px); left: 10px; }
        }
    </style>
</head>
<body>

<div class="status-header">
    <div style="display:flex; gap:8px; align-items:center;">
        <div id="alert-dot" style="width:8px; height:8px; border-radius:50%; background:#0f0;"></div>
        <div onclick="toggleHUD()" class="hud-toggle">[ HUD: ON ]</div>
    </div>
    
    <div style="display:flex; gap:10px; align-items:center;">
        <div onclick="openFaq()" style="cursor:pointer; color:var(--army-bright);">[ FAQ ]</div>
        <div id="clock">00:00:00 Z</div>
    </div>
</div>

<div id="faq-modal" onclick="closeFaq()" style="display:none; position:fixed; inset:0; z-index:5000; background:rgba(0,0,0,0.9); align-items:center; justify-content:center;">
    <div class="faq-content" style="background:var(--army-bg); border:2px solid var(--army-green); padding:20px; max-width:90%;" onclick="event.stopPropagation()">
        <h3 style="color:var(--army-bright);">MANUAL</h3>
        <p style="font-size:12px;">НАТИСНІТЬ [ HUD ], ЩОБ ПРИХОВАТИ ПАНЕЛЬ ЦІЛЕЙ ТА ЗВІЛЬНИТИ МІСЦЕ НА КАРТІ.</p>
        <button onclick="closeFaq()" style="width:100%; padding:10px; background:var(--army-green); color:white; border:none;">OK</button>
    </div>
</div>

<div class="tactical-list" id="targetList"></div>

<a href="https://send.monobank.ua/jar/6R3gd9Ew8w" target="_blank" class="supply-btn" id="donateBtn">ПІДТРИМКА [DONATE]</a>

<div class="disclaimer-bar">НЕ ОФІЦІЙНО. OSINT МОНІТОРИНГ. ТРИВОГА — В УКРИТТЯ!</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // ПЕРЕМИКАЧ HUD
    let isHudVisible = true;
    function toggleHUD() {
        const list = document.getElementById('targetList');
        const btn = document.getElementById('donateBtn');
        const toggle = document.querySelector('.hud-toggle');
        
        isHudVisible = !isHudVisible;
        
        if (isHudVisible) {
            list.classList.remove('hud-hidden');
            btn.classList.remove('btn-hidden');
            toggle.innerText = "[ HUD: ON ]";
        } else {
            list.classList.add('hud-hidden');
            btn.classList.add('btn-hidden');
            toggle.innerText = "[ HUD: OFF ]";
        }
    }

    // Решта логіки (Карта + Парсинг)
    const map = L.map('map', { zoomControl: false, attributionControl: false }).setView([49.99, 36.23], 9);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);

    function openFaq() { document.getElementById('faq-modal').style.display = 'flex'; }
    function closeFaq() { document.getElementById('faq-modal').style.display = 'none'; }

    // (Тут залишається твоя функція syncTactical для парсингу JSON)
    async function syncTactical() {
        try {
            const res = await fetch('targets.json?v=' + Date.now());
            const data = await res.json();
            const list = document.getElementById('targetList');
            list.innerHTML = '';
            data.forEach(t => {
                const card = document.createElement('div');
                card.className = `target-card ${t.status === 'active' ? 'active' : ''}`;
                card.innerHTML = `<div style="font-size:10px; color:var(--army-bright)">ID: ${t.id}</div><div style="font-size:14px; margin:5px 0;">${t.label}</div>`;
                list.appendChild(card);
            });
        } catch (e) {}
    }

    setInterval(() => {
        document.getElementById('clock').innerText = new Date().toLocaleTimeString() + ' Z';
    }, 1000);

    setInterval(syncTactical, 10000);
    syncTactical();
</script>
</body>
</html>
